\documentclass[12pt]{article}

\usepackage{graphicx}
\usepackage{tikz}

\usepackage[shortlabels]{enumitem}
\usepackage[colorlinks=]{hyperref}
\usepackage[margin=2cm]{geometry}

\title{Worksheet: LFPs and spectral analysis}
\author{Joaquin Rapela}

\begin{document}

\maketitle

Please show all your calculations required for your answers.

\begin{enumerate}

    \item We measure the LFP in human motor cortex with an Utah array. It is
        known that this LFP has only has an oscillation at 11~Hz (i.e.,
        $LFP(t)=A \cos(\omega_0\,t)$ with $\omega_0=2\pi\,11\,t$). However, when
        we sample this LFP at a frequency of 10~Hz we only observe an oscillation
        at 1~Hz (Figure~\ref{fig:undersampledLFP}).

        \begin{figure}
            \begin{center}
                \includegraphics[width=6in]{figures/undersampledLFP.png}

                \caption{An LFP oscillating at 11~Hz (i.e., $LFP(t)=A
                \cos(\omega_0\,t)$ with $\omega_0=2\pi\,11\,t$) when sampled at
                a frequency of 10~Hz (i.e., $f_s=10$~Hz or
                $\omega_s=2\pi\,10$~rad/sec) only displays an oscillation at
                1~Hz. Use the sampling theorem to explain this observation.
                Code to generate this figure appears \href{}{here}.}

            \end{center}
            \label{fig:undersampledLFP}
        \end{figure}

        \begin{enumerate}[(a)]

            \item explain the appearance of the 1~Hz oscillation using the
                sampling therem.

                Hints:

                \begin{itemize}

                    \item the Fourier transform of a cosine is
                        $\mathcal{FT}\{\cos(\omega_0
                        t)\}=\frac{1}{2}[\delta(-\omega_0)+\delta(\omega_0)]$
                        and has the spectrum in the figure below.
                        \input{figFTcos}

                    \item replicate the above spectrum, as indicated
                        by the sampling theorem, with new copies at multiples
                        of the sampling frequency $\omega_s=2\pi\,f_s$
                        ($f_s=\frac{1}{T_s}=10~Hz$).

                    \item check if any of the above replicates adds signal at
                        1~Hz (i.e., $\omega=2\pi\,1$~rad/sec).
                \end{itemize}

                Note: to avoid this type of problems of low-frequency
                oscillations appearing due to frequencies in the signal above
                the Nyquist frequency (i.e., half of the sampling frequency),
                before sampling signals are low pass filtered with an analog
                filter at the Nyquist frequency. This filter is called an
                \textbf{antialiasing filter}. The sampling theorem only applies
                to digital filters and therefore analog ones do not generate
                aliasing.

            \item build another example of an LFP having an oscillation at a
                high frequency that when sampled at a frequency below the
                Nyquist rate generates an oscillation at a lower frequency. You
                can use \href{}{this} code to verify that with your values of
                the the LFP frequency and the sampling frequency an oscillation
                at a low frequency emereges.

        \end{enumerate}

\end{enumerate}

\end{document}
